<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Urban Crave | Food Delivery</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --gold: #D4AF37; --dark: #050505; --card: #141414; --text: #f5f5f5; }
        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Outfit', sans-serif; }
        body { background: var(--dark); color: var(--text); padding-bottom: 90px; } /* Bottom Nav ke liye jagah */
        a { text-decoration: none; color: inherit; }

        /* Navbar */
        nav { display: flex; justify-content: space-between; align-items: center; padding: 15px 5%; background: rgba(5,5,5,0.95); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid #222; }
        .logo { font-size: 20px; font-weight: 900; letter-spacing: 0.5px; }
        .logo span { color: var(--gold); }
        .user-info { font-size: 14px; color: var(--gold); cursor: pointer; }

        /* Hero Section */
        .hero { height: 250px; margin: 15px; border-radius: 15px; background: url('https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800') center/cover; position: relative; display: flex; align-items: flex-end; padding: 20px; overflow: hidden; }
        .hero::before { content:''; position: absolute; inset:0; background: linear-gradient(0deg, #000 10%, transparent); }
        .hero-text { position: relative; z-index: 2; }
        .hero h1 { font-size: 24px; line-height: 1.2; margin-bottom: 5px; }
        .btn-mini { background: var(--gold); color: black; padding: 8px 20px; border-radius: 20px; font-size: 12px; font-weight: bold; display: inline-block; margin-top: 5px; }

        /* Categories (Round) */
        .cat-scroll { display: flex; gap: 15px; overflow-x: auto; padding: 20px 15px; scrollbar-width: none; }
        .cat-item { min-width: 70px; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .cat-img { width: 60px; height: 60px; border-radius: 50%; background: #222; display: flex; align-items: center; justify-content: center; border: 2px solid transparent; transition: 0.3s; }
        .cat-item.active .cat-img { border-color: var(--gold); background: #1a1a1a; }
        .cat-img i { font-size: 24px; color: var(--gold); }
        .cat-name { font-size: 12px; color: #aaa; }

        /* Product Grid (SMALLER SIZE FIX) */
        .section-title { padding: 0 15px; margin-bottom: 15px; font-size: 18px; font-weight: 700; display: flex; justify-content: space-between; align-items: center; }
        
        .grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); /* Mobile par 2 items */
            gap: 10px; 
            padding: 0 10px; 
        }
        
        .card { background: var(--card); border-radius: 10px; overflow: hidden; border: 1px solid #222; }
        .card img { width: 100%; height: 120px; object-fit: cover; }
        .card-info { padding: 10px; }
        .card h3 { font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 3px; }
        .card p { font-size: 10px; color: #888; margin-bottom: 8px; }
        .price-row { display: flex; justify-content: space-between; align-items: center; }
        .price { color: var(--gold); font-weight: bold; font-size: 14px; }
        .add-btn { width: 25px; height: 25px; background: #222; border: 1px solid var(--gold); color: var(--gold); border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 12px; cursor: pointer; }

        /* --- BOTTOM NAVIGATION (APP STYLE) --- */
        .bottom-nav { 
            position: fixed; 
            bottom: 0; 
            left: 0; 
            width: 100%; 
            background: #111; 
            border-top: 1px solid #333; 
            display: flex; 
            justify-content: space-around; 
            padding: 12px 0; 
            z-index: 1000;
            padding-bottom: max(12px, env(safe-area-inset-bottom));
        }
        .nav-btn { 
            color: #666; 
            text-align: center; 
            font-size: 10px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 4px; 
            text-decoration: none;
            width: 25%;
        }
        .nav-btn i { font-size: 20px; margin-bottom: 2px; }
        .nav-btn.active { color: var(--gold); }
        .cart-badge { background: red; color: white; border-radius: 50%; padding: 2px 5px; font-size: 9px; position: absolute; top: -5px; right: -5px; }

    </style>
</head>
<body>

    <nav>
        <div class="logo">URBAN<span>CRAVE.</span></div>
        <div class="user-info" onclick="window.location.href='login.html'">
            <i class="fas fa-user-circle"></i> <span id="userName">Login</span>
        </div>
    </nav>

    <div class="hero">
        <div class="hero-text">
            <h1>Crazy Deals<br><span style="color:var(--gold)">50% OFF</span></h1>
            <a href="menu.html" class="btn-mini">Order Now</a>
        </div>
    </div>

    <div class="cat-scroll">
        <div class="cat-item" onclick="location.href='menu.html'">
            <div class="cat-img"><i class="fas fa-utensils"></i></div>
            <span class="cat-name">All</span>
        </div>
        <div class="cat-item" onclick="location.href='menu.html?cat=Pizza'">
            <div class="cat-img"><i class="fas fa-pizza-slice"></i></div>
            <span class="cat-name">Pizza</span>
        </div>
        <div class="cat-item" onclick="location.href='menu.html?cat=Burger'">
            <div class="cat-img"><i class="fas fa-hamburger"></i></div>
            <span class="cat-name">Burger</span>
        </div>
        <div class="cat-item" onclick="location.href='menu.html?cat=Drinks'">
            <div class="cat-img"><i class="fas fa-cocktail"></i></div>
            <span class="cat-name">Drinks</span>
        </div>
    </div>

    <div class="section-title">
        <span>Trending Now ðŸ”¥</span>
        <a href="menu.html" style="font-size:12px; color:var(--gold)">See All</a>
    </div>

    <div class="grid" id="trendingGrid">
        <p style="color:#666; font-size:12px; text-align:center; grid-column:span 2;">Loading...</p>
    </div>

    <div class="bottom-nav">
        <a href="index.html" class="nav-btn active">
            <i class="fas fa-home"></i> Home
        </a>
        <a href="menu.html" class="nav-btn">
            <i class="fas fa-book-open"></i> Menu
        </a>
        <a href="tel:+916377390984" class="nav-btn">
            <i class="fas fa-phone-alt"></i> Call
        </a>
        <a href="menu.html" class="nav-btn" style="position:relative;">
            <i class="fas fa-shopping-bag"></i> Cart
            <span class="cart-badge" id="navCartCount" style="display:none">0</span>
        </a>
    </div>

    <script>
        // 1. Check Login
        const user = localStorage.getItem('urbanUser');
        if(user) {
            document.getElementById('userName').innerText = JSON.parse(user).name;
        }

        // 2. Fetch Trending Items
        async function loadTrending() {
            try {
                const res = await fetch('/.netlify/functions/api');
                const data = await res.json();
                const grid = document.getElementById('trendingGrid');
                grid.innerHTML = "";
                
                // Show first 4 items only
                data.slice(0, 4).forEach(p => {
                    grid.innerHTML += `
                    <div class="card" onclick="location.href='menu.html'">
                        <img src="${p.image_url}" onerror="this.src='https://via.placeholder.com/200'">
                        <div class="card-info">
                            <h3>${p.name}</h3>
                            <p>${p.category}</p>
                            <div class="price-row">
                                <span class="price">â‚¹${p.price}</span>
                                <div class="add-btn"><i class="fas fa-plus"></i></div>
                            </div>
                        </div>
                    </div>`;
                });
            } catch(e) { console.log(e); }
        }
        
        // 3. Update Cart Badge
        const cart = JSON.parse(localStorage.getItem('urbanCart')) || [];
        if(cart.length > 0) {
            const badge = document.getElementById('navCartCount');
            badge.innerText = cart.reduce((a,b)=>a+b.qty, 0);
            badge.style.display = 'block';
        }

        loadTrending();
    </script>
</body>
</html>
